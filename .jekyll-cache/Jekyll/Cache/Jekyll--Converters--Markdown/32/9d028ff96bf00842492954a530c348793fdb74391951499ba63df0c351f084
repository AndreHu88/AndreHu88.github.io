I"˜<h3 id="1-ç®€å•pushåŠ¨ç”»å’ŒpresentåŠ¨ç”»">1. ç®€å•pushåŠ¨ç”»å’ŒpresentåŠ¨ç”»</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[self.navigationController.view.layer addAnimation:[self pushAnimation] forKey:@""];
[self.navigationController pushViewController:[] animated:NO];

[self.view.window.layer addAnimation:[self presentAnimation] forKey:nil];
[self presentViewController:second animated:NO completion:nil]; 

//ç³»ç»Ÿçš„API
- (void)addAnimation:(CAAnimation *)anim forKey:(nullable NSString *)key;
</code></pre></div></div>
<p>è‡ªå®šä¹‰pushåŠ¨ç”»ï¼Œç„¶ååœ¨pushæ—¶æ·»åŠ åˆ°navigationControllerä¸­
CATransition -&gt; CAAnimation -&gt; NSObject</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    CATransition *transition = [CATransition animation];
    transition.duration = 0.6;
    transition.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionDefault];
    
    //åŠ¨ç”»ç±»å‹ï¼Œä¸€ä¸‹æ˜¯ç³»ç»ŸAPIçš„ä»‹ç»
    /* The name of the transition. Current legal transition types include
     * `fade', `moveIn', `push' and `reveal'. Defaults to `fade'. */
    transition.type = @"";

    /*ç§æœ‰API
     cube                   ç«‹æ–¹ä½“æ•ˆæœ
     pageCurl               å‘ä¸Šç¿»ä¸€é¡µ
     pageUnCurl             å‘ä¸‹ç¿»ä¸€é¡µ
     rippleEffect           æ°´æ»´æ³¢åŠ¨æ•ˆæœ
     suckEffect             å˜æˆå°å¸ƒå—é£èµ°çš„æ„Ÿè§‰
     oglFlip                ä¸Šä¸‹ç¿»è½¬
     cameraIrisHollowClose  ç›¸æœºé•œå¤´å…³é—­æ•ˆæœ
     cameraIrisHollowOpen   ç›¸æœºé•œå¤´æ‰“å¼€æ•ˆæœ
     */
</code></pre></div></div>
<p>æœ€åpushæˆ–presenté¡µé¢å°±å¯ä»¥å®ŒæˆåŠ¨ç”»</p>

<h3 id="2éäº¤äº’å¼è½¬åœºåŠ¨ç”»">2.éäº¤äº’å¼è½¬åœºåŠ¨ç”»</h3>
<ul>
  <li>1.éœ€è¦å½“å‰çš„navigationControlleréµå¾ª<UINavigationControllerDelegate>å¹¶å®ç°å…¶ä»£ç†æ–¹æ³•</UINavigationControllerDelegate></li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>//å¯ä»¥åœ¨æ­¤ä»£ç†æ–¹æ³•ä¸­åˆ¤æ–­å½“å‰æ˜¯pushè¿˜æ˜¯pop
-  (nullable id &lt;UIViewControllerAnimatedTransitioning&gt;)navigationController:(UINavigationController *)navigationController
                                   animationControllerForOperation:(UINavigationControllerOperation)operation
                                                fromViewController:(UIViewController *)fromVC
                                                  toViewController:(UIViewController *)toVC 
</code></pre></div></div>

<ul>
  <li>2.æˆ‘ä»¬éœ€è¦åœ¨ä»£ç†æ–¹æ³•ä¸­è¿”å›ä¸€ä¸ªUIViewControllerAnimatedTransitioningå¯¹è±¡ï¼Œäºæ˜¯æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç±»ç»§æ‰¿è‡ªNSObjectï¼Œéµå¾ª<UIViewControllerAnimatedTransitioning>åè®®ï¼Œå¹¶å®ç°å…¶ä»£ç†æ–¹æ³•
ä»£ç†æ–¹æ³•ä¸»è¦æœ‰ä»¥ä¸‹2ä¸ª</UIViewControllerAnimatedTransitioning></li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// This is used for percent driven interactive transitions, as well as for
// container controllers that have companion animations that might need to
// synchronize with the main animation.
//è¿”å›åŠ¨ç”»çš„æ—¶é•¿
- (NSTimeInterval)transitionDuration:(nullable id &lt;UIViewControllerContextTransitioning&gt;)transitionContext;

// This method can only  be a nop if the transition is interactive and not a percentDriven interactive transition.
//å®ç°å…·ä½“çš„åŠ¨ç”»
- (void)animateTransition:(id &lt;UIViewControllerContextTransitioning&gt;)transitionContext;
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>//è½¬åœºè¿‡æ¸¡çš„å®¹å™¨view
UIView *containerView = [transitionContext containerView];
//FromVC
UIViewController *fromViewController = [transitionContext viewControllerForKey:UITransitionContextFromViewControllerKey];
UIView *fromView = fromViewController.view;

//ToVC
UIViewController *toViewController = [transitionContext viewControllerForKey:UITransitionContextToViewControllerKey];
UIView *toView = toViewController.view;

NSInteger toVCCount = [toViewController.navigationController.viewControllers indexOfObject:toViewController];
NSInteger fromVCCount = [fromViewController.navigationController.viewControllers indexOfObject:fromViewController];
if (toVCCount &gt; fromVCCount) {
   //push
    [containerView addSubview:fromView];
    [containerView addSubview:toView];
}
else{
  //pop
    [containerView addSubview:toView];
    [containerView addSubview:fromView];
}

[UIView animateWithDuration:[self transitionDuration:transitionContext] animations:^{
        //å…·ä½“çš„åŠ¨ç”»å®ç°

  } completion:^(BOOL finished) {
        BOOL wasCancelled = [transitionContext transitionWasCancelled];
        //è®¾ç½®transitionContexté€šçŸ¥ç³»ç»ŸåŠ¨ç”»æ‰§è¡Œå®Œæ¯•
        [transitionContext completeTransition:!wasCancelled];
}];
</code></pre></div></div>

<h5 id="å®ç°é…·ç‹—çš„è½¬åœºåŠ¨ç”»">å®ç°é…·ç‹—çš„è½¬åœºåŠ¨ç”»</h5>
<p>*åˆ†åˆ«åˆ›å»ºä¸¤ä¸ªç±»ç»§æ‰¿è‡ªNSObjectï¼Œéµå¾ª<UIViewControllerAnimatedTransitioning>åè®®ï¼Œæ¥å®ç°pushå’Œpopçš„åŠ¨ç”»æ•ˆæœ*</UIViewControllerAnimatedTransitioning></p>

<ul>
  <li>1.pushåŠ¨ç”»,å°†å°†pushçš„viewåšä»¿å°„å˜æ¢</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- (void)animateTransition:(id&lt;UIViewControllerContextTransitioning&gt;)transitionContext;

//è½¬åœºè¿‡æ¸¡çš„å®¹å™¨view
UIView *containerView = [transitionContext containerView];
//ToVC
UIViewController *toViewController = [transitionContext viewControllerForKey:UITransitionContextToViewControllerKey];
UIView *toView = toViewController.view;
[containerView addSubview:toView];

//å°†toViewç»•åŸç‚¹æ—‹è½¬45åº¦
toView.transform = 
</code></pre></div></div>
<ul>
  <li>2.popåŠ¨ç”»åŒç†</li>
  <li>3.äº¤äº’å¼è½¬åœºåŠ¨ç”»</li>
</ul>
<UINavigationControllerDelegate>å®ç°å…¶ä»£ç†æ–¹æ³•

```
- (nullable id <UIViewControllerInteractiveTransitioning>)navigationController:(UINavigationController *)navigationController
                          interactionControllerForAnimationController:(id <UIViewControllerAnimatedTransitioning>) animationController
```
å®ç°è¿™ä¸ªæ–¹æ³•ï¼Œç³»ç»Ÿè½¬åœºæ—¶ï¼Œå°±ä¼šçŸ¥é“å½“å‰æ˜¯å¦æœ‰äº¤äº’å¼çš„è½¬åœºï¼Œæœ‰ä¾¿æ‰§è¡Œäº¤äº’è½¬åœºï¼Œæ— åˆ™æ‰§è¡Œæ™®é€šè‡ªå®šä¹‰çš„è½¬åœºåŠ¨ç”»
```UIPercentDrivenInteractiveTransition```ç±»æ˜¯ç³»ç»Ÿå®šä¹‰çš„ï¼Œä»–éµå¾ª```UIViewControllerInteractiveTransitioning```åè®®
æ­¤ç±»æä¾›äº†äº†ä»¥ä¸‹æ–¹æ³•

```
// These methods should be called by the gesture recognizer or some other logic
// to drive the interaction. This style of interaction controller should only be
// used with an animator that implements a CA style transition in the animator's
// animateTransition: method. If this type of interaction controller is
// specified, the animateTransition: method must ensure to call the
// UIViewControllerTransitionParameters completeTransition: method. The other
// interactive methods on UIViewControllerContextTransitioning should NOT be
// called. If there is an interruptible animator, these methods will either scrub or continue 
// the transition in the forward or reverse directions.

- (void)updateInteractiveTransition:(CGFloat)percentComplete;
- (void)cancelInteractiveTransition;
- (void)finishInteractiveTransition;
```
æ ¹æ®popæ—¶ä¼ é€’çš„æ‰‹åŠ¿ä¿¡æ¯æ¥è®¡ç®—æ»‘åŠ¨ç™¾åˆ†æ¯”ï¼Œä»è€Œå®Œæˆäº¤äº’åŠ¨ç”»å’Œå–æ¶ˆåŠ¨ç”»


</UIViewControllerAnimatedTransitioning></UIViewControllerInteractiveTransitioning></UINavigationControllerDelegate>
:ET